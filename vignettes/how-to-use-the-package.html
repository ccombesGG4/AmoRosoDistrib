<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Hon Keung Tony Ng and Catherine Combes" />

<meta name="date" content="2020-10-14" />

<title>Package AmoRosoDistrib</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Package AmoRosoDistrib</h1>
<h4 class="author">Hon Keung Tony Ng and Catherine Combes</h4>
<h4 class="date">2020-10-14</h4>



<p>The goal of this document is get you up and running with the AmoRosoDistrib as quickly as possible.</p>
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>Generalized Gamma distribution is often called a Amoroso family of df’s (Amoroso, 1925) because it encompasses the natural unification of the gamma and extreme value distribution families. It has initially be described by Amoroso in 1925 who applied it to fit income rates and to model lifetimes. The form commonly used in practice was suggested by Stacy (1962), Stacy and Minhram (1965) and corresponds to three-parameter exponentiated gamma distribution. Harter (1967) proposes the four-parameter Generalized Gamma in including location parameter.</p>
<p>This distribution is robust and flexible parametric distribution for modeling many types of data.</p>
<p>Amoroso family distributions cover over 50 distinct distributions and can be considered as a functional form encapsulating and systematizing an extensive menagerie of interesting and common probability distributions.</p>
<p>One of the most interesting problems is constructing the distributions, which are appropriate for fitting skewed and heavy-tailed data sets which are possible with GG4-Distribution. More, the GG4 family includes all four of the most common types of hazard function: monotonically increasing and decreasing, as well as bathtub and arc-shaped hazards used in survival analysis. So, the GG-distribution has long been recognized as an important probability distribution in reliability modelling, analysis of lifetimes and the flexibility makes it especially attractive as a tentative model observed phenomena.</p>
<p>The form commonly used in practice was suggested by Stacy (1962), Stacy and Minhram (1965) corresponds to three-parameter exponentiated gamma distribution. Harter (1967) proposes the four-parameter generalized gamma distribution in including location parameter.</p>
<p>The package proposes density, distribution function, quantile function, random generation and hazards for the generalized gamma distribution (called GG4), using the parameterisation originating from Amoroso (1925). It also proposes a method based on minimum distance estimation problem for estimate the four-parameters from an univariate sample and an empirical adaptation for bivariate population.</p>
</div>
<div id="notations" class="section level2">
<h2>Notations</h2>
<p>Let be <span class="math inline">\(Y\)</span>, a random variable that follows a so-called four-parameter Generalized Gamma distribution <span class="math inline">\(GG4\)</span> (<span class="math inline">\(a\)</span>,<span class="math inline">\(\ell\)</span>,<span class="math inline">\(c\)</span>,<span class="math inline">\(\mu\)</span>) introduced by Amoroso (1925). A GG4-distribution is the absolutely continuous distribution defined by the probability density function (pdf): <span class="math display">\[g(y;a,\ell,c,\mu) = \vert c \vert \frac{1}{a^{\ell c} \Gamma(\ell)} \left(  y - \mu \right)^{\ell c - 1} \exp \left[ - \left( \frac{y - \mu}{a}  \right)^{c} \right] \]</span> The cumulative distribution function is given by: <span class="math display">\[G_Y(y) = P[Y \leq y ]= 1-\frac{\gamma \left( \ell, \left(\frac{y - \mu}{a}\right)^c \right)}{\Gamma(l)} \]</span> Where</p>
<ul>
<li><p><span class="math inline">\(\ell\)</span> is the shape parameter, <span class="math inline">\(\ell \in \Re^{+*}\)</span>,</p></li>
<li><p><span class="math inline">\(c\)</span> is the shape parameter called family or power shape parameter, <span class="math inline">\(c \in \Re\)</span> ,</p></li>
<li><p><span class="math inline">\(a\)</span> is the scale parameter, <span class="math inline">\(a \in \Re\)</span> with <span class="math inline">\(a \neq 0\)</span></p></li>
<li><p><span class="math inline">\(\mu\)</span> is called shift or location parameter, <span class="math inline">\(\mu \in \Re\)</span></p></li>
<li><p><span class="math inline">\(\Gamma(.)\)</span> is the gamma function defined by: <span class="math inline">\(\int_0^\infty y^{\ell-1} e^{-y}dy\)</span></p></li>
<li><p><span class="math inline">\(\gamma(.,.)\)</span> is the lower incomplete gamma function.</p></li>
</ul>
</div>
<div id="amoroso-family-distributions" class="section level2">
<h2>Amoroso family distributions</h2>
<p>When the power shape parameter <strong><span class="math inline">\(c\)</span></strong> is negative, the distribution becomes a generalized inverse gamma. The parent of various inverse distributions include the Pearson V (inverse Pearson III) and inverse gamma, the inverse chi family, the inverse Rayleigh and the generalized Fréchet. Crocks (2015) presents a review of important properties of the Amoroso distribution that many common and interesting probability distributions occur as special cases or limits (such as power law, log-gamma, log-normal and normal distributions). See also (Jonshon et al.,1995).</p>
<p>So, the four-parameter Generalized Gamma distribution (GGD4) is a very popular distribution because it includes many well-known distributions and have been a great interest in practical application.</p>
</div>
<div id="gg4-functions" class="section level2">
<h2>GG4 functions</h2>
<div id="description" class="section level3">
<h3>Description</h3>
<p>Probability distribution functions (p), density functions (d), quantile functions (q), and random number generation (r) generation for univariate parametric distribution of the four-parameter generalized Gamma (GG4) with location, scale and shape parameters (non-censoed and non-truncated).</p>
</div>
<div id="value" class="section level3">
<h3>Value</h3>
<ul>
<li>dgg4 gives the density function,</li>
<li>pgg4 gives the distribution function,</li>
<li>qgg4 gives the quantile function,</li>
<li>rgg4 generates random deviates.</li>
</ul>
<p>We also propose hgg4 representing the hazard function and chgg4 corresponding to the cumulative hazard function.</p>
<p>GG4-samples (rgg4) are generated by using the property:</p>
<p>If <span class="math inline">\(Z \sim Gamma \left( 1,\ell \right)\)</span> then <span class="math inline">\(Y = aZ^\frac{1}{c} + \mu \sim GG(a,\ell,c,\mu)\)</span></p>
</div>
<div id="usage" class="section level3">
<h3>Usage</h3>
<ul>
<li><p>dgg4(x, a, l, c, mu = 0)</p></li>
<li><p>pgg4(q, a, l, c, mu = 0, lower.tail = TRUE, log.p = FALSE)</p></li>
<li><p>qgg4(p, a, l, c, mu = 0, lower.tail = TRUE)</p></li>
<li><p>rgg4(n, a, l, c, mu = 0)</p></li>
<li><p>hgg4(x, a, l, c, mu = 0)</p></li>
<li><p>chgg4(x, a, l, c, mu = 0)</p></li>
</ul>
<p>###Arguments</p>
<ul>
<li><p>x, q: vector of quantiles.</p></li>
<li><p>mu: Vector of “location” parameters. Initialized to zero if no value.</p></li>
<li><p>a: Vector of “scale” parameters. Constrained to be different to zero.</p></li>
<li><p>l: Vector of “shape” parameters.</p></li>
<li><p>c: Vector of “power shape” parameters (also called “family shape” parameter). power.tail: logical; if TRUE (default), probabilities are P(Y &lt;= y), otherwise, P(Y &gt; y).</p></li>
<li><p>p: vector of probabilities.</p></li>
<li><p>n: number of observations. If length(n) &gt; 1, the length is taken to be the number required.</p></li>
</ul>
</div>
<div id="references" class="section level3">
<h3>References</h3>
<p>Amoroso, L. (1925). Ricerche intorno alla curva dei redditi, <em>Annali de Mathematica</em>, <strong>series 2 (1)</strong>, 123-159.</p>
<p>Crooks, G. E. (2015). <em>The amoroso distribution</em>, arXiv e-prints arXiv:1005.3274v2arXiv:1005.3274v2.</p>
<p>Stacy, E. W. (1962). A generalization of the gamma distribution, <em>Ann. Math. Statist.</em>, <strong>33:3</strong>, 1187–1192.</p>
<p>Stacy, E. W. and Mihram, G. A. (1965). Parameter estimation for a generalized gamma distribution, <em>Technometrics</em>, <strong>7:3</strong>, 349–358.</p>
<p>Harter, H. L. (1967). Maximum-likelihood estimation of the parameters of a four- parameter generalized gamma population from complete and censored samples. <em>Technometrics</em>, <strong>9:1</strong>, 159–165.</p>
<p>Johnson,N. L., Kotz, S., Balakrishnan, N. (1995). <em>Continuous univariate distribution</em>, 2cd edition John WILEY &amp; Sons INC, New York.</p>
</div>
<div id="examples" class="section level3">
<h3>Examples</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># R code</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="co"># ======</span></a>
<a class="sourceLine" id="cb1-3" title="3"></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw">library</span> (AmoRosoDistrib)</a>
<a class="sourceLine" id="cb1-5" title="5"></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="co">#=======================</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="co"># Tests of gg4 functions</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="co">#=======================</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="co">#=====</span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="co"># c&gt;0</span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="co">#=====</span></a>
<a class="sourceLine" id="cb1-12" title="12"><span class="kw">dgg4</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">a=</span><span class="dv">1</span>, <span class="dt">l=</span><span class="fl">0.5</span>, <span class="dt">c=</span><span class="fl">0.8</span>)</a>
<a class="sourceLine" id="cb1-13" title="13"><span class="kw">pgg4</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">1</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>)</a>
<a class="sourceLine" id="cb1-14" title="14"><span class="kw">qgg4</span>(<span class="kw">seq</span>(<span class="fl">0.9</span>, <span class="fl">0.6</span>, <span class="fl">-0.1</span>), <span class="dv">2</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>)</a>
<a class="sourceLine" id="cb1-15" title="15"><span class="kw">rgg4</span>(<span class="dv">6</span>, <span class="dv">1</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>)</a>
<a class="sourceLine" id="cb1-16" title="16">p &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="dv">9</span>)<span class="op">/</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb1-17" title="17"><span class="kw">pgg4</span>(<span class="kw">qgg4</span>(p, <span class="dv">1</span>, <span class="dv">2</span>, <span class="fl">0.8</span>), <span class="dv">1</span>, <span class="dv">2</span>, <span class="fl">0.8</span>)</a>
<a class="sourceLine" id="cb1-18" title="18"><span class="co">## [1] 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9</span></a>
<a class="sourceLine" id="cb1-19" title="19"></a>
<a class="sourceLine" id="cb1-20" title="20"><span class="co">#=====</span></a>
<a class="sourceLine" id="cb1-21" title="21"><span class="co"># c&lt;0</span></a>
<a class="sourceLine" id="cb1-22" title="22"><span class="co">#=====</span></a>
<a class="sourceLine" id="cb1-23" title="23"><span class="kw">dgg4</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">a=</span><span class="dv">1</span>, <span class="dt">l=</span><span class="fl">0.5</span>, <span class="dt">c=</span><span class="op">-</span><span class="fl">0.8</span>)</a>
<a class="sourceLine" id="cb1-24" title="24"><span class="kw">pgg4</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">1</span>, <span class="fl">0.5</span>, <span class="fl">-0.8</span>)</a>
<a class="sourceLine" id="cb1-25" title="25"><span class="kw">qgg4</span>(<span class="kw">seq</span>(<span class="fl">0.9</span>, <span class="fl">0.6</span>, <span class="fl">-0.1</span>), <span class="dv">2</span>, <span class="fl">0.5</span>, <span class="fl">-0.8</span>)</a>
<a class="sourceLine" id="cb1-26" title="26"><span class="kw">rgg4</span>(<span class="dv">6</span>, <span class="dv">1</span>, <span class="fl">0.5</span>, <span class="fl">-0.8</span>)</a>
<a class="sourceLine" id="cb1-27" title="27">p &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="dv">9</span>)<span class="op">/</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb1-28" title="28"><span class="kw">pgg4</span>(<span class="kw">qgg4</span>(p, <span class="dv">1</span>, <span class="dv">2</span>, <span class="fl">-0.8</span>), <span class="dv">1</span>, <span class="dv">2</span>, <span class="fl">-0.8</span>)</a>
<a class="sourceLine" id="cb1-29" title="29"><span class="co">## [1] 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9</span></a>
<a class="sourceLine" id="cb1-30" title="30"></a>
<a class="sourceLine" id="cb1-31" title="31"><span class="co"># with location param mu</span></a>
<a class="sourceLine" id="cb1-32" title="32"><span class="co">#========================</span></a>
<a class="sourceLine" id="cb1-33" title="33"><span class="kw">dgg4</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">a =</span> <span class="dv">2</span>, <span class="dt">l =</span> <span class="fl">0.5</span>, <span class="dt">c =</span> <span class="fl">0.8</span>, <span class="dt">mu =</span> <span class="fl">1.5</span>) <span class="co"># attention q&lt;mu so, if q=2:4 then mu &lt; 2</span></a>
<a class="sourceLine" id="cb1-34" title="34"><span class="kw">pgg4</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">a =</span> <span class="dv">2</span>, <span class="dt">l =</span> <span class="fl">0.5</span>, <span class="dt">c =</span> <span class="fl">0.8</span>, <span class="dt">mu =</span> <span class="fl">1.5</span>) <span class="co"># attention q&lt;mu so, if q=2:4 then mu &lt; 2</span></a>
<a class="sourceLine" id="cb1-35" title="35"><span class="kw">qgg4</span>(<span class="kw">seq</span>(<span class="fl">0.9</span>, <span class="fl">0.6</span>, <span class="fl">-0.1</span>), <span class="dt">a =</span> <span class="dv">2</span>, <span class="dt">l =</span> <span class="fl">0.5</span>, <span class="dt">c =</span> <span class="fl">0.8</span>, <span class="dt">mu =</span> <span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb1-36" title="36"><span class="kw">rgg4</span>(<span class="dv">6</span>, <span class="dt">a =</span> <span class="dv">2</span>, <span class="dt">l =</span> <span class="fl">0.5</span>, <span class="dt">c =</span> <span class="fl">0.8</span>, <span class="dt">mu =</span> <span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb1-37" title="37">p &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="dv">9</span>)<span class="op">/</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb1-38" title="38"><span class="kw">pgg4</span>(<span class="kw">qgg4</span>(p, <span class="dt">a =</span> <span class="dv">2</span>, <span class="dt">l =</span> <span class="fl">0.5</span>, <span class="dt">c =</span> <span class="fl">0.8</span>, <span class="dt">mu =</span> <span class="fl">1.5</span>), <span class="dt">a =</span> <span class="dv">2</span>, <span class="dt">l =</span> <span class="fl">0.5</span>, <span class="dt">c =</span> <span class="fl">0.8</span>, <span class="dt">mu =</span> <span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb1-39" title="39"><span class="co">## [1] 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9</span></a>
<a class="sourceLine" id="cb1-40" title="40"></a>
<a class="sourceLine" id="cb1-41" title="41"><span class="kw">set.seed</span>(<span class="dv">963</span>)</a>
<a class="sourceLine" id="cb1-42" title="42">qq =<span class="st"> </span><span class="kw">qgg4</span>(<span class="kw">runif</span>(<span class="dv">100</span>),<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb1-43" title="43"></a>
<a class="sourceLine" id="cb1-44" title="44"><span class="kw">set.seed</span>(<span class="dv">963</span>)</a>
<a class="sourceLine" id="cb1-45" title="45">rr =<span class="st"> </span><span class="kw">rgg4</span>(<span class="dv">100</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb1-46" title="46"></a>
<a class="sourceLine" id="cb1-47" title="47"><span class="kw">set.seed</span>(<span class="dv">963</span>)</a>
<a class="sourceLine" id="cb1-48" title="48">q =<span class="st"> </span><span class="kw">sort</span>(rr)</a>
<a class="sourceLine" id="cb1-49" title="49">pp1 =<span class="st"> </span><span class="kw">pgg4</span>(q,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb1-50" title="50">pp2 =<span class="st"> </span><span class="kw">pgg4</span>(q,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dt">lower.tail =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1-51" title="51"></a>
<a class="sourceLine" id="cb1-52" title="52"><span class="kw">set.seed</span>(<span class="dv">963</span>)</a>
<a class="sourceLine" id="cb1-53" title="53">dd =<span class="st"> </span><span class="kw">dgg4</span>(q,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb1-54" title="54"></a>
<a class="sourceLine" id="cb1-55" title="55"><span class="kw">set.seed</span>(<span class="dv">963</span>)</a>
<a class="sourceLine" id="cb1-56" title="56">hh =<span class="st"> </span><span class="kw">hgg4</span>(q,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb1-57" title="57"></a>
<a class="sourceLine" id="cb1-58" title="58"><span class="kw">set.seed</span>(<span class="dv">963</span>)</a>
<a class="sourceLine" id="cb1-59" title="59">chh =<span class="st"> </span><span class="kw">chgg4</span>(q,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)</a></code></pre></div>
</div>
</div>
<div id="minimum-distance-estimation-for-mimicing-gg4-distribution" class="section level2">
<h2>Minimum distance estimation for mimicing GG4 distribution</h2>
<div id="problematic" class="section level3">
<h3>Problematic</h3>
<p>If parameter estimation is easy for a gamma distribution (<span class="math inline">\(c = 1\)</span>), the estimation becomes more complex when the power shape parameter <strong><span class="math inline">\(c\)</span></strong> is added in the density function.</p>
<p>The difficulty increases also with the fact that different sets of parameters conduce to same density function.</p>
<p>Maximum likelihood is a common approach for estimating model parameters based on large sample theory, so this method often works poorly.</p>
<p>It is therefore very interesting to look for alternative methods to estimate the parameters such as heuristics that allow us to avoid all difficulties. The flexibility of the attempts to estimate the parameters of GGD4 with iterative procedures coupled Monte Carlo simulation makes especially attractive and have been largely studied. But, the estimation of the power shape parameter <span class="math inline">\(c\)</span> is always a real problem.</p>
</div>
<div id="aim-to-fit-a-sample-an-univariate-population-non-censored-and-non-trucated-data-to-the-four-parameter-generalized-gamma-distribution-model." class="section level3">
<h3>Aim : To fit a sample (an univariate population, non-censored and non-trucated data) to the four-parameter generalized gamma distribution model.</h3>
<p>The approach is different that moment or maximum likelihood approach. It is a heuristic based on the minimum distance estimation (Wolfowitz, 1957). Minimum distance estimation is widely developed in the literature (Bassu et al., 2011) and the most popular inference methods are based on the problem of goodness-of-fit testing on the empirical distribution function such as:</p>
<ul>
<li><p>maximum likelihood estimation,</p></li>
<li><p>minimum chisquare,</p></li>
<li><p>method of moments,</p></li>
<li><p>Kolmogorov–Smirnov or Cramér-von Mises or anderson-darling test.</p></li>
</ul>
<p>For more information, see the R packages:</p>
<ul>
<li><p>“distrMod: Object Oriented Implementation of Probability Models” with the function “MDEstimator”</p></li>
<li><p>“actuar: Actuarial Functions and Heavy Tailed Distributions” “mde”.</p></li>
</ul>
<p>The objective is to search for a distribution function that is as close as possible to the empirical distribution given by the observed data. But these methods do not work well to estimate the parameters of de GG4 distribution.</p>
<p>Millar (1984) explored the asymptotic behavior of the Minimum Distance estimate (MDE) within a general framework. An intuitive understanding of MDE can be seen from the estimator constructed by the minimum distance of the empirical distribution function and the unknown distribution function.</p>
<p>DEB RAJOUT.</p>
<p>A recurrent problem in statistical machine learning is the choice of a relevant distance measure to compare probability distributions. Information divergences are famous such as (non-exhaustive list):</p>
<ul>
<li>Euclidian</li>
<li>Mahalanobis</li>
<li>Kullback-Leibler</li>
<li>Hellinger</li>
<li>Itakura-Saito (Burg entropy)</li>
<li><span class="math inline">\(\chi^2\)</span></li>
<li><span class="math inline">\(l_p\)</span> (quasi-)norm</li>
<li>total variation</li>
<li>logistic loss function</li>
<li>Csiszár and Bregman divergences</li>
</ul>
<p>with an alternative family of distances between probability distributions introduced in the framework of optimal transport(OT).</p>
<p>FIN RAJOUT.</p>
<p>We adapt the approach on seven distance estimations which are proposed in an objective function. By default direct optimization is performed using optim(). The process is iterative and incremental and used with Monte-Carlo simulation (replications) in order to explore the space - problematic of local extremum.</p>
</div>
<div id="description-1" class="section level3">
<h3>Description</h3>
<p>Functions to fit a sample (univariate population – non-censored data) to generalized gamma family. Note that different sets of parameters conduce to same density function with Amoroso family df’s.</p>
</div>
<div id="value-1" class="section level3">
<h3>Value</h3>
<ul>
<li>mimicgg4 function for approximation from a sample (univariate population) to theoritical model based on the four-parameter Generalized Gamma family distributions.</li>
</ul>
</div>
<div id="usage-1" class="section level3">
<h3>Usage</h3>
<ul>
<li>mimicgg4(data, distance = “Wass”, par_init = c(0.15,0.15,-0.15,0.15), seed = 963, iter = 10)</li>
</ul>
</div>
<div id="arguments" class="section level3">
<h3>Arguments</h3>
<ul>
<li><p>data: sample (univariate population) to mimic.</p></li>
<li><p>distance: A character string coding for the fitting method. Seven distances are proposed:</p>
<pre><code>      + &quot;Wass&quot; for Wasserstein distance, 
      + &quot;Burg&quot; for Burg entropy,
      + &quot;NegBurg&quot; for Negative Burg entropy, 
      + &quot;Chi2&quot; for chi-squared distance,
      + &quot;Euclid&quot; for the well-known Euclidian distance, 
      + &quot;Hell&quot; for Hellinger distance,
      + &quot;HL1N&quot; for half l1-norm distance. 
      All distances are described below. 
      Default value: &quot;Wass&quot; for Wasserstein distance.</code></pre></li>
<li><p>para_init: vector of the initial values of parameters . Default values: c(0.15,0.15,-0.15,0.15) corresponding to c(a,l,c,mu) for GG4.</p></li>
<li><p>seed: Number corresponding to the initialized kernel of random number generation. Default value = 963</p></li>
<li><p>iter: Number of iterations. Default value = 10.</p></li>
</ul>
</div>
<div id="the-seven-distances" class="section level3">
<h3>The seven distances</h3>
<p>The new estimation method called ‘mimic’ is based on optimization and simulation coupling approaches. The proposed method is very practical and straightforward.</p>
<p>Seven new estimators were proposed incorporating minimum distance estimation for determining the “four-best” parameters of GG4.</p>
<p>The concept is near to the minimum distance approach in order to identify a distribution function (with the corresponding parameters) that is as close as possible to the empirical distribution with the following estimators:</p>
<ol style="list-style-type: decimal">
<li><p>distance = “Wass” – Wasserstein (also known as Earth mover’s distance or written Vaserstein) metric is a distance function defined between probability distributions on a given metric space M,</p></li>
<li><p>distance = “Burg” – Burg Divergence is a Bregman divergence which measures of how one probability distribution diverges from a second expected probability distribution,</p></li>
<li><p>distance = “NegBurg” – for Negative Burg Entopy is a (pre-)Bregman divergence,</p></li>
<li><p>distance = “chi2” – for chi-squared distance,</p></li>
<li><p>distance = “Euclid” – for Euclidian distance,</p></li>
<li><p>distance = “Hell” – for Hellinger distance,</p></li>
<li><p>distance = “HL1N” – for half l1-norm distance.</p></li>
</ol>
<p>Let be a given dataset <span class="math inline">\(X = (x_1,x_2,..x_n)\)</span> which models unknown distribution of a statistical data set <span class="math inline">\(Y = (y_1,y_2,..y_n)\)</span>, <span class="math inline">\(Y\)</span> corresponds to a random generation dataset modelling an univariate distribution of GG4.</p>
<p>Note: <em>each data set are sorted:</em> X = sort(<span class="math inline">\(x_i\)</span>) and Y = sort(<span class="math inline">\(y_i\)</span>) for <em>i</em> = 1 to <em>n</em></p>
<p>What is the “best” dissimilarities (or distance or divergence) to fit theoritical probability distribution from a sample (an univariate population)?</p>
<div id="wasserstein-distance" class="section level4">
<h4>Wasserstein distance</h4>
<p><em>Remind about Wasserstein metric:</em> In the theory of optimal transport, the distance between the two distributions called Wasserstein, Kantorovich or earth-mover distance permits to define the minimum transportation cost. The p-Wasserstein distance allows us to compare data probability distributions. For more information, see the R package “transport: Computation of Optimal Transport Plans and Wasserstein Distances” and the article (Gibbs and Su, 2002)</p>
<p><em>Characteristic:</em> The Wasserstein distance of order <strong>p</strong> is defined as the p-th root of the total cost incurred when transporting measure <strong>X</strong> to measure <strong>Y</strong> in an optimal way, where the cost of transporting is given as the p-th power of the Euclidean distance: <span class="math inline">\(||x_i - y_i||^p\)</span></p>
<p>The Wasserstein Minimum Estimator (WME) corresponds to: <span class="math display">\[\left[ \frac {1} {n}\sum_{i=1}^n |y_i-x_i|^p \right]^{\frac{1}{p}}\]</span></p>
<p><em>Principle:</em> to minimize the p-wasserstein distance between a given dataset <span class="math inline">\(X\)</span> which models unknown distribution and a statistical data set <span class="math inline">\(Y\)</span> corresponding to a random generation dataset modelling an univariate distribution of GG4.</p>
</div>
<div id="burg-entropy-divergence" class="section level4">
<h4>Burg Entropy Divergence</h4>
<p><em>Characteristics:</em> The Burg Minimum Estimator (BME) is a Bregman divergence and corresponds to:</p>
<p><span class="math display">\[\sum_{i=1}^n \left[\frac{x_i} {y_i} - log \left( \frac{x_i} {y_i} \right) - 1 \right]\]</span></p>
<p><em>Principle:</em> The principle is the following. Let be a given dataset <strong>X</strong> which models unknown distribution of a statistical data set <strong>P</strong>. In this approach, <strong>P</strong> is considered to be the « target distribution » (that is, the ‘true’ distribution). We are trying to approximate by a theoretical distribution model <strong>Q</strong> of Amoroso family distributions. We can evaluate candidate distributions <strong>Q</strong> using the Burg-divergence from <strong>P</strong> to <strong>Q</strong>. Burg-divergence is used as an optimization criterion which is minimized in order to find the best candidate/approximation <strong>Q</strong> (with the corresponding theoretical distribution function).</p>
</div>
<div id="negative-burg-entropy-divergence" class="section level4">
<h4>Negative Burg Entropy Divergence</h4>
<p><em>Characteristics</em>: Negative Burg entropy corresponds to a (pre-)Bregman divergence, also known as the Itakura-Saito divergence (Reem et al., 2018).</p>
<p><span class="math display">\[\sum_{i=1}^n \left[ log \left( \frac{y_i} {x_i}\right) + \frac{x_i} {y_i} - 1  \right]\]</span></p>
<p><strong>Principle:</strong> We consider the negative burg such as a distance to minimize such as the principle described for the Burg Entropy.</p>
</div>
<div id="chi-squared-distance" class="section level4">
<h4>Chi-squared distance</h4>
<p><em>Characteristic:</em> For a countable state space, the well-known chi-squared distance: <span class="math display">\[\sum_{i=1}^n \frac{(x_i - y_i)^2} {y_i}\]</span> .</p>
<p><em>Principle:</em> To minimize chi-squared distance. For more information, see the article (Gibbs and Su, 2002).</p>
</div>
<div id="euclidian-distance" class="section level4">
<h4>Euclidian distance</h4>
<p><em>Characteristics:</em> the Euclidean distance:</p>
<p><span class="math display">\[\sum_{i=1}^n||x_i - y_i||^2\]</span></p>
<p><em>Principle:</em> To minimize the Euclidian distance.</p>
</div>
<div id="hellinger-distance" class="section level4">
<h4>Hellinger distance</h4>
<p><em>Characteristics:</em> For a countable state space, the Hellinger distance is defined by: <span class="math display">\[\left( \sum_{i=1}^n(\sqrt{x_i} - \sqrt{y_i})^2 \right)^\frac{1}{2}\]</span></p>
<p><em>Principle:</em> To minimize the Hellinger distance only possible if the observations are positives (<span class="math inline">\(x_i\geq 0\)</span> for <span class="math inline">\(i = 1\)</span> to <span class="math inline">\(n\)</span>). For more information, see the article (Gibbs and Su, 2002).</p>
<p><em>Advantage:</em> Efficiency and robustness are two fundamental concepts in parametric estimation problems. It has been shown that minimum Hellinger estimators (MHE) achieve efficiency at the model density and simultaneously have excellent robustness properties (Beran, 1977). MHD approach are originally developed for parametric models and is one way of reconciling the conflicting concepts of efficiency and robustness. It can also be applied successfully for certain semiparametric models (Wu and Karunamuni, 2009).</p>
</div>
</div>
<div id="half-l1-norm-distance" class="section level3">
<h3>half l1-norm distance</h3>
<p><em>Characteristics:</em> For a countable state space, the half l1-norm distance is defined by: <span class="math display">\[\frac {1} {2}\sum_{i=1}^n |x_i-y_i|\]</span></p>
<p><em>Principle:</em> To minimize the half l1-norm distance. This metric assumes values in [0,1]. For more information, see the article (Gibbs and Su, 2002).</p>
</div>
<div id="optimization" class="section level3">
<h3>Optimization</h3>
<p>Optimization is performed using stats::optim() function. For one-dimensional problems the Nelder-Mead method is used and for multi-dimensional problems the BFGS method, unless arguments named lower or upper are supplied when L-BFGS-B is used or method is supplied explicitly.</p>
<p>see stats::optim() function to obtain information concerning the six methods (“Nelder-Mead”, “BFGS”, “CG”, “L-BFGS-B”, “SANN”,“Brent”). General-purpose optimization based on Nelder–Mead, quasi-Newton and conjugate-gradient algorithms. It includes an option for box-constrained optimization and simulated annealing.</p>
<p>optim(par, fn, gr = NULL, …, method = c(“Nelder-Mead”, “BFGS”, “CG”, “L-BFGS-B”, “SANN”, “Brent”), lower = -Inf, upper = Inf, control = list(), hessian = FALSE)</p>
</div>
<div id="replication" class="section level3">
<h3>Replication</h3>
<p>stats::replicate() is a wrapper for the common use of sapply for repeated evaluation of an expression (which will usually involve random number generation).</p>
</div>
<div id="references-1" class="section level3">
<h3>References</h3>
<p>Basu, A., Shioya, H., Park, C.(2011). <em>Statistical Inference: The Minimum Distance Approach</em>. Chanseok Chapman &amp; Hall/CRC. 409 pages. hardcover ISBN : 978‐1‐4200‐9965‐2</p>
<p>Beran, R. (1977). Minimum Hellinger distance estimates for parametric models. <em>Annals of Statistics</em>, <strong>5</strong>, 445–463.</p>
<p>Gibbs, A. L. and Su, F. E. (2002). On Choosing and Bounding Probability Metrics. <em>International Statistical Review</em>, <strong>70(3)</strong>, 419–-435.</p>
<p>Reem, D., Reich, S., and De Pierro, A. (2018). Re-examination of Bregman functions and new properties of their divergences. <em>Optimization</em>, 1–-70. <a href="doi:10.1080/02331934.2018.1543295" class="uri">doi:10.1080/02331934.2018.1543295</a></p>
<p>Millar P.W. (1984). A general approach to the optimality of minimum distance estimators. <em>Trans. Amer. Math. Soc.</em>, <strong>286:1</strong>, 377–418</p>
<p>Wolfowitz, J. (1957). The minimum distance method. <em>The Annals of Mathematical Statistics</em>, Institute of Mathematical Statistics, <strong>28 (1)</strong>, 75-–88. <a href="doi:10.1214/aoms/1177707038" class="uri">doi:10.1214/aoms/1177707038</a>. ISSN 0020-3157. Retrieved February 18, 2013.</p>
<p>Wu, J., and Karunamuni, R. (2009). On minimum Hellinger distance estimation. <em>The Canadian Journal of Statistics / La Revue Canadienne De Statistique</em>, <strong>37(4)</strong>, 514-533. Retrieved from www.jstor.org/stable/25653496</p>
</div>
<div id="example" class="section level3">
<h3>Example</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="co"># R code</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="co"># ======</span></a>
<a class="sourceLine" id="cb3-3" title="3"></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="kw">library</span> (AmoRosoDistrib)</a>
<a class="sourceLine" id="cb3-5" title="5"></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co">#==============================</span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="co"># To search the &quot;best&quot; fitting</span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="co">#==============================</span></a>
<a class="sourceLine" id="cb3-9" title="9"></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="co"># How to explore the space (problem of local optimum in optimization) ?</span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="co"># To make replications</span></a>
<a class="sourceLine" id="cb3-12" title="12"></a>
<a class="sourceLine" id="cb3-13" title="13">n =<span class="st"> </span><span class="dv">30</span> <span class="co"># n value corresponding to the sample size for fitting</span></a>
<a class="sourceLine" id="cb3-14" title="14"><span class="co">## set.seed function to get reproducible results</span></a>
<a class="sourceLine" id="cb3-15" title="15"><span class="kw">set.seed</span>(<span class="dv">963</span>)</a>
<a class="sourceLine" id="cb3-16" title="16">MyData =<span class="st"> </span><span class="kw">rgg4</span>(n,<span class="dv">3</span>,<span class="dv">2</span>,<span class="op">-</span><span class="fl">1.75</span>,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb3-17" title="17">MyData</a>
<a class="sourceLine" id="cb3-18" title="18">nrSimul =<span class="st"> </span><span class="dv">150</span></a>
<a class="sourceLine" id="cb3-19" title="19"></a>
<a class="sourceLine" id="cb3-20" title="20"><span class="co"># Waiting time some minutes.........</span></a>
<a class="sourceLine" id="cb3-21" title="21">allRep &lt;-<span class="st"> </span><span class="kw">replicate</span>(nrSimul,(<span class="kw">mimicgg4</span>(<span class="dt">data =</span> MyData, <span class="dt">distance =</span> <span class="st">&quot;Wass&quot;</span>,</a>
<a class="sourceLine" id="cb3-22" title="22">                                      <span class="dt">par_init =</span> <span class="kw">c</span>(<span class="fl">0.35</span>,<span class="fl">0.35</span>,<span class="op">-</span><span class="fl">0.15</span>,<span class="fl">0.35</span>),</a>
<a class="sourceLine" id="cb3-23" title="23">                                      <span class="dt">seed =</span> <span class="kw">round</span>(<span class="kw">runif</span>(<span class="dv">1</span>,<span class="dt">min =</span> <span class="dv">1</span>,<span class="dt">max  =</span> <span class="dv">10</span><span class="op">^</span><span class="dv">8</span>)),</a>
<a class="sourceLine" id="cb3-24" title="24">                                      <span class="dt">iter =</span> <span class="dv">10</span>)))</a>
<a class="sourceLine" id="cb3-25" title="25"></a>
<a class="sourceLine" id="cb3-26" title="26">allRep</a>
<a class="sourceLine" id="cb3-27" title="27"></a>
<a class="sourceLine" id="cb3-28" title="28"><span class="co">####################################################</span></a>
<a class="sourceLine" id="cb3-29" title="29"></a>
<a class="sourceLine" id="cb3-30" title="30">j =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb3-31" title="31">min_w =<span class="st"> </span><span class="dv">9999999</span></a>
<a class="sourceLine" id="cb3-32" title="32"><span class="kw">require</span>(transport)</a>
<a class="sourceLine" id="cb3-33" title="33"></a>
<a class="sourceLine" id="cb3-34" title="34"></a>
<a class="sourceLine" id="cb3-35" title="35"><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></a>
<a class="sourceLine" id="cb3-36" title="36"><span class="co"># Wassertein distance</span></a>
<a class="sourceLine" id="cb3-37" title="37"><span class="cf">for</span> (j <span class="cf">in</span>  <span class="dv">1</span><span class="op">:</span>nrSimul) {</a>
<a class="sourceLine" id="cb3-38" title="38">  wa =<span class="st"> </span>allRep[<span class="dv">1</span>,j]</a>
<a class="sourceLine" id="cb3-39" title="39">  wl =<span class="st"> </span><span class="kw">abs</span>(allRep[<span class="dv">2</span>,j])</a>
<a class="sourceLine" id="cb3-40" title="40">  wc =<span class="st"> </span>allRep[<span class="dv">3</span>,j]</a>
<a class="sourceLine" id="cb3-41" title="41">  wmu =<span class="st"> </span>allRep[<span class="dv">4</span>,j]</a>
<a class="sourceLine" id="cb3-42" title="42"></a>
<a class="sourceLine" id="cb3-43" title="43">  <span class="kw">set.seed</span>(<span class="dv">963</span>) <span class="co"># generalized cases of GG4</span></a>
<a class="sourceLine" id="cb3-44" title="44">  w.est =<span class="st"> </span><span class="kw">rgg4</span>(n,wa,wl,wc,wmu)</a>
<a class="sourceLine" id="cb3-45" title="45"></a>
<a class="sourceLine" id="cb3-46" title="46">  w =<span class="st"> </span><span class="kw">wasserstein1d</span>(MyData,w.est,<span class="dt">p =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb3-47" title="47">  <span class="cf">if</span> (w <span class="op">!=</span><span class="st"> &quot;NaN&quot;</span>) {</a>
<a class="sourceLine" id="cb3-48" title="48">    <span class="cf">if</span> (min_w <span class="op">&gt;</span><span class="st"> </span>w) {</a>
<a class="sourceLine" id="cb3-49" title="49">      min_w =<span class="st"> </span>w</a>
<a class="sourceLine" id="cb3-50" title="50">      rw =<span class="st"> </span>j</a>
<a class="sourceLine" id="cb3-51" title="51">    }</a>
<a class="sourceLine" id="cb3-52" title="52">  }</a>
<a class="sourceLine" id="cb3-53" title="53">}</a>
<a class="sourceLine" id="cb3-54" title="54"></a>
<a class="sourceLine" id="cb3-55" title="55">rw</a>
<a class="sourceLine" id="cb3-56" title="56">min_w</a>
<a class="sourceLine" id="cb3-57" title="57"></a>
<a class="sourceLine" id="cb3-58" title="58">wwa =<span class="st"> </span>(allRep[<span class="dv">1</span>,rw])</a>
<a class="sourceLine" id="cb3-59" title="59">wwl =<span class="st"> </span>(allRep[<span class="dv">2</span>,rw])</a>
<a class="sourceLine" id="cb3-60" title="60">wwc =<span class="st"> </span>(allRep[<span class="dv">3</span>,rw])</a>
<a class="sourceLine" id="cb3-61" title="61">wwmu =<span class="st"> </span>(allRep[<span class="dv">4</span>,rw])</a>
<a class="sourceLine" id="cb3-62" title="62"><span class="kw">c</span>(wwa,wwl,wwc,wwmu)</a>
<a class="sourceLine" id="cb3-63" title="63"></a>
<a class="sourceLine" id="cb3-64" title="64"><span class="kw">set.seed</span>(<span class="dv">963</span>)</a>
<a class="sourceLine" id="cb3-65" title="65">y_est =<span class="st"> </span><span class="kw">rgg4</span>(<span class="kw">length</span>(MyData),wwa,wwl,wwc,wwmu)</a>
<a class="sourceLine" id="cb3-66" title="66"></a>
<a class="sourceLine" id="cb3-67" title="67"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb3-68" title="68"><span class="co"># The comparison of density curves between univariate population and estimated population from theoritical models</span></a>
<a class="sourceLine" id="cb3-69" title="69"></a>
<a class="sourceLine" id="cb3-70" title="70"><span class="kw">plot</span>(<span class="kw">density</span>(MyData), <span class="dt">col =</span> <span class="st">&quot;Red&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span> , <span class="dt">lty =</span> <span class="dv">3</span>,  <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">1.65</span>),  <span class="dt">main =</span> <span class="st">&#39;Density comparison&#39;</span>, <span class="dt">xlab =</span> <span class="st">&#39;&#39;</span>,<span class="dt">ylab =</span> <span class="st">&#39;values&#39;</span>)</a>
<a class="sourceLine" id="cb3-71" title="71"></a>
<a class="sourceLine" id="cb3-72" title="72"><span class="kw">lines</span>(<span class="kw">density</span>(y_est), <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">lty =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb3-73" title="73"></a>
<a class="sourceLine" id="cb3-74" title="74"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;Sample&quot;</span>, <span class="st">&quot;Estimated&quot;</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>) , <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">5</span>),  <span class="dt">title =</span> <span class="st">&quot;Legend&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">cex =</span> <span class="fl">0.75</span>)</a>
<a class="sourceLine" id="cb3-75" title="75"></a>
<a class="sourceLine" id="cb3-76" title="76"></a>
<a class="sourceLine" id="cb3-77" title="77"><span class="co"># the corresponding QQ-Plots</span></a>
<a class="sourceLine" id="cb3-78" title="78">Obs =<span class="st"> </span><span class="kw">sort</span>(MyData)</a>
<a class="sourceLine" id="cb3-79" title="79">Wass =<span class="st"> </span><span class="kw">sort</span>(y_est)</a>
<a class="sourceLine" id="cb3-80" title="80"><span class="kw">qqplot</span>(Obs, Wass)</a>
<a class="sourceLine" id="cb3-81" title="81"></a>
<a class="sourceLine" id="cb3-82" title="82"><span class="co">#===================================================</span></a>
<a class="sourceLine" id="cb3-83" title="83"><span class="co">#  Example 1 in order to explain the term of &quot;mimic&quot;</span></a>
<a class="sourceLine" id="cb3-84" title="84"><span class="co">#===================================================</span></a>
<a class="sourceLine" id="cb3-85" title="85"><span class="co"># Sample generation with initialization kernel of pseudo random number</span></a>
<a class="sourceLine" id="cb3-86" title="86"><span class="kw">set.seed</span>(<span class="dv">963</span>)</a>
<a class="sourceLine" id="cb3-87" title="87">MyData=<span class="kw">rgg4</span>(<span class="dt">n=</span><span class="dv">1000</span>,<span class="dt">a=</span><span class="dv">2</span>,<span class="dt">l=</span><span class="dv">3</span>,<span class="dt">c=</span><span class="op">-</span><span class="fl">0.75</span>,<span class="dt">mu=</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb3-88" title="88"></a>
<a class="sourceLine" id="cb3-89" title="89"><span class="co"># Fit univariate sample in order to identify the four parameters</span></a>
<a class="sourceLine" id="cb3-90" title="90"><span class="co"># with burg divergence method (different of moment method and maximum likelihood method)</span></a>
<a class="sourceLine" id="cb3-91" title="91">res=<span class="kw">mimicgg4</span>(<span class="dt">data=</span>MyData, <span class="dt">distance =</span> <span class="st">&quot;Burg&quot;</span>, <span class="dt">par_init=</span><span class="kw">c</span>(<span class="fl">0.15</span>,<span class="fl">0.15</span>,<span class="op">-</span><span class="fl">0.15</span>,<span class="fl">0.15</span>), <span class="dt">seed=</span><span class="dv">963</span>, <span class="dt">iter=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb3-92" title="92"><span class="co"># res[1]=a, res[2]=l, res[3]=c, res[4]=mu</span></a>
<a class="sourceLine" id="cb3-93" title="93">res</a>
<a class="sourceLine" id="cb3-94" title="94"><span class="co">#[1]  0.7983483  0.2650324 -8.3710544  4.3995720</span></a>
<a class="sourceLine" id="cb3-95" title="95"></a>
<a class="sourceLine" id="cb3-96" title="96"><span class="co"># The comparison of density curves between univariate population and estimated population</span></a>
<a class="sourceLine" id="cb3-97" title="97">col =<span class="st"> </span><span class="kw">rainbow</span>(<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb3-98" title="98"><span class="kw">plot</span>(<span class="kw">density</span>(MyData), <span class="dt">col =</span> col[<span class="dv">1</span>], <span class="dt">lwd =</span> <span class="dv">3</span> , <span class="dt">lty=</span><span class="dv">3</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">1.1</span>), <span class="dt">main =</span> <span class="st">&#39;ddp comparison&#39;</span>, <span class="dt">xlab=</span><span class="st">&#39;&#39;</span>,<span class="dt">ylab=</span><span class="st">&#39;values&#39;</span>)</a>
<a class="sourceLine" id="cb3-99" title="99"><span class="kw">set.seed</span>(<span class="dv">963</span>)</a>
<a class="sourceLine" id="cb3-100" title="100">Theo_Data =<span class="st"> </span><span class="kw">rgg4</span>(<span class="kw">length</span>(MyData),res[<span class="dv">1</span>], <span class="kw">abs</span>(res[<span class="dv">2</span>]),res[<span class="dv">3</span>],res[<span class="dv">4</span>])</a>
<a class="sourceLine" id="cb3-101" title="101"><span class="kw">lines</span>(<span class="kw">density</span>(Theo_Data), <span class="dt">col =</span> col[<span class="dv">2</span>], <span class="dt">lwd =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb3-102" title="102"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;Sample&quot;</span>,<span class="st">&quot;Estimated sample&quot;</span>), <span class="dt">col =</span> col, <span class="dt">title=</span><span class="st">&quot;Legend&quot;</span> ,<span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">lwd=</span> <span class="dv">2</span>,<span class="dt">cex=</span><span class="fl">0.8</span>)</a>
<a class="sourceLine" id="cb3-103" title="103"></a>
<a class="sourceLine" id="cb3-104" title="104"></a>
<a class="sourceLine" id="cb3-105" title="105"><span class="co">#=============================================================</span></a>
<a class="sourceLine" id="cb3-106" title="106"><span class="co">#  Example 2: impact of the choice of parameter initialization</span></a>
<a class="sourceLine" id="cb3-107" title="107"><span class="co">#=============================================================</span></a>
<a class="sourceLine" id="cb3-108" title="108"><span class="co"># Sample generation with initialization kernel of pseudo random number</span></a>
<a class="sourceLine" id="cb3-109" title="109"><span class="kw">set.seed</span>(<span class="dv">963</span>)</a>
<a class="sourceLine" id="cb3-110" title="110">obs=<span class="kw">rgg4</span>(<span class="dt">n=</span><span class="dv">1000</span>,<span class="dt">a=</span><span class="dv">2</span>,<span class="dt">l=</span><span class="dv">3</span>,<span class="dt">c=</span><span class="op">-</span><span class="fl">1.68</span>,<span class="dt">mu=</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb3-111" title="111"></a>
<a class="sourceLine" id="cb3-112" title="112"><span class="co"># Fit univariate sample in order to identify the four parameters</span></a>
<a class="sourceLine" id="cb3-113" title="113"><span class="co"># with burg divergence method (different of moment method and maximum likelihood method)</span></a>
<a class="sourceLine" id="cb3-114" title="114">res=<span class="kw">mimicgg4</span>(<span class="dt">data=</span>MyData, <span class="dt">distance =</span> <span class="st">&quot;Burg&quot;</span>, <span class="dt">par_init=</span><span class="kw">c</span>(<span class="fl">0.15</span>,<span class="fl">0.15</span>,<span class="op">-</span><span class="fl">0.15</span>,<span class="fl">0.15</span>), <span class="dt">seed=</span><span class="dv">963</span>, <span class="dt">iter=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb3-115" title="115"><span class="co"># res[1]=a, res[2]=l, res[3]=c, res[4]=mu</span></a>
<a class="sourceLine" id="cb3-116" title="116">res</a>
<a class="sourceLine" id="cb3-117" title="117"><span class="co">#[1]  0.7983483  0.2650324 -8.3710544  4.3995720</span></a>
<a class="sourceLine" id="cb3-118" title="118"></a>
<a class="sourceLine" id="cb3-119" title="119"><span class="co"># c is now initialized to -0.11 (first value -0.15)</span></a>
<a class="sourceLine" id="cb3-120" title="120">res=<span class="kw">mimicgg4</span>(<span class="dt">data=</span>MyData, <span class="dt">distance =</span> <span class="st">&quot;Burg&quot;</span>, <span class="dt">par_init=</span><span class="kw">c</span>(<span class="fl">0.15</span>,<span class="fl">0.15</span>,<span class="op">-</span><span class="fl">0.11</span>,<span class="fl">0.15</span>), <span class="dt">seed=</span><span class="dv">963</span>, <span class="dt">iter=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb3-121" title="121">res</a>
<a class="sourceLine" id="cb3-122" title="122"><span class="co">#[1]  2.0000016  3.0000011 -0.7499998  5.00000011</span></a>
<a class="sourceLine" id="cb3-123" title="123"></a>
<a class="sourceLine" id="cb3-124" title="124"><span class="co"># ==============</span></a>
<a class="sourceLine" id="cb3-125" title="125"><span class="co"># Other example</span></a>
<a class="sourceLine" id="cb3-126" title="126"><span class="co"># ==============</span></a>
<a class="sourceLine" id="cb3-127" title="127"><span class="kw">set.seed</span>(<span class="dv">963</span>)</a>
<a class="sourceLine" id="cb3-128" title="128">MyData=<span class="kw">rgg4</span>(<span class="dv">1000</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="op">-</span><span class="fl">2.75</span>,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb3-129" title="129">res=<span class="kw">mimicgg4</span>(<span class="dt">data=</span>MyData, <span class="dt">distance =</span> <span class="st">&quot;Burg&quot;</span>, <span class="dt">par_init=</span><span class="kw">c</span>(<span class="fl">0.15</span>,<span class="fl">0.15</span>,<span class="fl">0.15</span>,<span class="fl">0.15</span>), <span class="dt">seed=</span><span class="dv">963</span>, <span class="dt">iter=</span><span class="dv">4</span>) <span class="co"># initial value c&gt;0</span></a>
<a class="sourceLine" id="cb3-130" title="130">res</a>
<a class="sourceLine" id="cb3-131" title="131"><span class="co">#[1]  0.03387208 8.37650815 0.69538676 5.77722771</span></a>
<a class="sourceLine" id="cb3-132" title="132"></a>
<a class="sourceLine" id="cb3-133" title="133"><span class="co"># To test with  par_init=c(0.15,0.15,-0.15,0.15) </span></a>
<a class="sourceLine" id="cb3-134" title="134"><span class="co"># but it is necessary to have 8 iterations !!!!</span></a>
<a class="sourceLine" id="cb3-135" title="135">res=<span class="kw">mimicgg4</span>(<span class="dt">data=</span>MyData, <span class="dt">distance =</span> <span class="st">&quot;Burg&quot;</span>, <span class="dt">par_init=</span><span class="kw">c</span>(<span class="fl">0.15</span>,<span class="fl">0.15</span>,<span class="op">-</span><span class="fl">0.15</span>,<span class="fl">0.15</span>), <span class="dt">seed=</span><span class="dv">963</span>, <span class="dt">iter=</span><span class="dv">8</span>) <span class="co"># initial value c&gt;0</span></a>
<a class="sourceLine" id="cb3-136" title="136">res</a>
<a class="sourceLine" id="cb3-137" title="137"><span class="co">#[1]  2.000254  3.001172 -2.748890  5.000246</span></a>
<a class="sourceLine" id="cb3-138" title="138"></a>
<a class="sourceLine" id="cb3-139" title="139"></a>
<a class="sourceLine" id="cb3-140" title="140"><span class="co">#==================================</span></a>
<a class="sourceLine" id="cb3-141" title="141"><span class="co"># data set: flexsurv::bosms4$years</span></a>
<a class="sourceLine" id="cb3-142" title="142"><span class="co">#==================================</span></a>
<a class="sourceLine" id="cb3-143" title="143"></a>
<a class="sourceLine" id="cb3-144" title="144">MyData =<span class="st"> </span>flexsurv<span class="op">::</span>bosms4<span class="op">$</span>years</a>
<a class="sourceLine" id="cb3-145" title="145"><span class="kw">plot</span>(<span class="kw">density</span>(MyData))</a>
<a class="sourceLine" id="cb3-146" title="146"><span class="co"># it is interesting to test two cases for c parameter initialization c &gt; 0 (0.15) and c &lt; 0 (-0.15)</span></a>
<a class="sourceLine" id="cb3-147" title="147">res =<span class="st"> </span><span class="kw">mimicgg4</span>(<span class="dt">data =</span> MyData, <span class="dt">distance =</span> <span class="st">&quot;Burg&quot;</span>, <span class="dt">par_init=</span><span class="kw">c</span>(<span class="fl">0.15</span>,<span class="fl">0.15</span>,<span class="fl">0.15</span>,<span class="fl">0.15</span>), <span class="dt">seed =</span> <span class="dv">963</span>, <span class="dt">iter =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb3-148" title="148">res</a>
<a class="sourceLine" id="cb3-149" title="149"><span class="co">#[1] 5.183743165 0.407853719 1.631653484 0.001558139</span></a>
<a class="sourceLine" id="cb3-150" title="150"></a>
<a class="sourceLine" id="cb3-151" title="151"><span class="co"># The comparison of density curves between the population (with lepturkotic mix) and estimated population</span></a>
<a class="sourceLine" id="cb3-152" title="152">col =<span class="st"> </span><span class="kw">rainbow</span>(<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb3-153" title="153"><span class="kw">plot</span>(<span class="kw">density</span>(MyData), <span class="dt">col =</span> col[<span class="dv">1</span>], <span class="dt">lwd =</span> <span class="dv">3</span> , <span class="dt">lty=</span><span class="dv">3</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>), <span class="dt">main =</span> <span class="st">&#39;ddp comparison&#39;</span>, <span class="dt">xlab=</span><span class="st">&#39;&#39;</span>,<span class="dt">ylab=</span><span class="st">&#39;values&#39;</span>)</a>
<a class="sourceLine" id="cb3-154" title="154"><span class="kw">set.seed</span>(<span class="dv">963</span>)</a>
<a class="sourceLine" id="cb3-155" title="155">Theo_Data =<span class="st"> </span><span class="kw">rgg4</span>(<span class="kw">length</span>(MyData),res[<span class="dv">1</span>], <span class="kw">abs</span>(res[<span class="dv">2</span>]),res[<span class="dv">3</span>],res[<span class="dv">4</span>])</a>
<a class="sourceLine" id="cb3-156" title="156"><span class="kw">lines</span>(<span class="kw">density</span>(Theo_Data), <span class="dt">col =</span> col[<span class="dv">2</span>], <span class="dt">lwd =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb3-157" title="157"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;bosms4$years&quot;</span>,<span class="st">&quot;Estimated sample&quot;</span>), <span class="dt">col =</span> col, <span class="dt">title=</span><span class="st">&quot;Legend&quot;</span> ,<span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">lwd=</span> <span class="dv">2</span>,<span class="dt">cex=</span><span class="fl">0.8</span>)</a>
<a class="sourceLine" id="cb3-158" title="158"></a>
<a class="sourceLine" id="cb3-159" title="159"><span class="kw">qqplot</span>(MyData, Theo_Data)</a></code></pre></div>
</div>
</div>
<div id="log-likelihood-estimation" class="section level2">
<h2>Log-Likelihood estimation</h2>
<div id="description-2" class="section level3">
<h3>Description</h3>
<p>The log-likelihood of the generalized gamma distribution. The likelihood function for the GG distribution using a sample of size <span class="math inline">\(n\)</span> can be derived as: <span class="math display">\[ \log L^* = -nc \log(a) + n \log \vert c \vert - n \log \left(\Gamma (\ell) \right) + (\ell c - 1) \sum_{i=1}^n \log\left( y_i - \mu \right) - a^{-c} \sum_{i=1}^n \left(y_i - \mu \right)^c \]</span> Return the log likelihood of generalized gamma GG4(a,l,c,mu).</p>
</div>
<div id="usage-2" class="section level3">
<h3>Usage</h3>
<ul>
<li>logLgg4(data, a, l, c, mu)</li>
</ul>
</div>
<div id="arguments-1" class="section level3">
<h3>Arguments</h3>
<ul>
<li>data: the observed sample</li>
<li>a: scale parameter of GG4 distribution</li>
<li>l: shape parameter of GG4 distribution</li>
<li>c: power shape parameter of GG4 distribution</li>
<li>mu: location parameter of GG4 distribution</li>
</ul>
<p>log likelihood of generalized gamma GG4(a,l,c,mu) from param data</p>
</div>
</div>
<div id="maximum-likelihood-estimation" class="section level2">
<h2>Maximum Likelihood estimation</h2>
<div id="description-3" class="section level3">
<h3>Description</h3>
<ul>
<li>MaxLikEgg4: GG4 maximum log-likelihood parameter estimation with stats::optim function method = “BFGS” and the corresponding hessian.</li>
<li>MLikEgg4: GG4 maximum log-likelihood parameter estimation of the generalized gamma distribution with stats::optim function = c(“Nelder-Mead”, “BFGS”, “CG”, “L-BFGS-B”, “SANN”,“Brent”).</li>
</ul>
</div>
<div id="usage-3" class="section level3">
<h3>Usage</h3>
<ul>
<li><p>MaxLikEgg4(data, par_init = c(0.15, 0.15, 0.15, 0.15))</p></li>
<li><p>MLikEgg4(data, par_init=c(0.15,0.15,-0.15,0.15))</p></li>
</ul>
</div>
<div id="arguments-2" class="section level3">
<h3>Arguments</h3>
<ul>
<li>data: the observed sample</li>
<li>par_init: vextor of the initial values of parameters</li>
</ul>
</div>
<div id="references-2" class="section level3">
<h3>References</h3>
</div>
<div id="examples-1" class="section level3">
<h3>Examples</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="co"># R code</span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="co"># ======</span></a>
<a class="sourceLine" id="cb4-3" title="3"></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="kw">library</span> (AmoRosoDistrib)</a>
<a class="sourceLine" id="cb4-5" title="5">n =<span class="st"> </span><span class="dv">500</span></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb4-7" title="7">MyData =<span class="st"> </span><span class="kw">rgg4</span>(n, <span class="dt">a =</span> <span class="fl">2.1</span>, <span class="dt">l =</span> <span class="fl">3.63</span>, <span class="dt">c =</span> <span class="fl">-2.75</span>, <span class="dt">mu =</span> <span class="fl">5.52</span>)</a>
<a class="sourceLine" id="cb4-8" title="8"></a>
<a class="sourceLine" id="cb4-9" title="9">MyHessian &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb4-10" title="10">MyHessian =<span class="st"> </span><span class="kw">MaxLikEgg4</span>(<span class="dt">data =</span> MyData, <span class="dt">par_init =</span> <span class="kw">c</span>(<span class="fl">0.015</span>,<span class="fl">0.015</span>,<span class="op">-</span><span class="fl">0.015</span>,<span class="fl">0.015</span>))</a>
<a class="sourceLine" id="cb4-11" title="11">MyHessian</a>
<a class="sourceLine" id="cb4-12" title="12"></a>
<a class="sourceLine" id="cb4-13" title="13">allRepMLE &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb4-14" title="14"></a>
<a class="sourceLine" id="cb4-15" title="15">allRepMLE &lt;-<span class="st"> </span><span class="kw">MLikEgg4</span>(<span class="dt">data =</span> MyData, <span class="dt">par_init =</span> <span class="kw">c</span>(<span class="fl">0.015</span>,<span class="fl">0.015</span>,<span class="op">-</span><span class="fl">0.015</span>,<span class="fl">0.015</span>))</a>
<a class="sourceLine" id="cb4-16" title="16">lla  =<span class="st"> </span>allRepMLE[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb4-17" title="17">lll  =<span class="st"> </span>allRepMLE[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb4-18" title="18">llc  =<span class="st"> </span>allRepMLE[<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb4-19" title="19">llmu =<span class="st"> </span>allRepMLE[<span class="dv">4</span>]</a>
<a class="sourceLine" id="cb4-20" title="20">allRepMLE</a>
<a class="sourceLine" id="cb4-21" title="21"></a>
<a class="sourceLine" id="cb4-22" title="22"><span class="kw">c</span>(lla,lll,llc,llmu)</a>
<a class="sourceLine" id="cb4-23" title="23"></a>
<a class="sourceLine" id="cb4-24" title="24"></a>
<a class="sourceLine" id="cb4-25" title="25"><span class="co">#set.seed(123)</span></a>
<a class="sourceLine" id="cb4-26" title="26">MyMLE =<span class="st"> </span><span class="kw">rgg4</span>(n,lla,lll,llc,llmu)</a>
<a class="sourceLine" id="cb4-27" title="27"></a>
<a class="sourceLine" id="cb4-28" title="28">data =<span class="st"> </span><span class="kw">sort</span>(MyData)</a>
<a class="sourceLine" id="cb4-29" title="29">data_MLE =<span class="st"> </span><span class="kw">sort</span>(MyMLE)</a>
<a class="sourceLine" id="cb4-30" title="30"></a>
<a class="sourceLine" id="cb4-31" title="31"><span class="kw">require</span>(transport)</a>
<a class="sourceLine" id="cb4-32" title="32">w_MLE =<span class="st">  </span><span class="kw">wasserstein1d</span>(data,data_MLE)</a>
<a class="sourceLine" id="cb4-33" title="33">w_MLE</a>
<a class="sourceLine" id="cb4-34" title="34"></a>
<a class="sourceLine" id="cb4-35" title="35"></a>
<a class="sourceLine" id="cb4-36" title="36"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb4-37" title="37"><span class="co"># The comparison of density curves between univariate population and estimated population from theoritical models</span></a>
<a class="sourceLine" id="cb4-38" title="38"></a>
<a class="sourceLine" id="cb4-39" title="39"><span class="kw">plot</span>(<span class="kw">density</span>(MyData), <span class="dt">col =</span> <span class="st">&quot;Red&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span> , <span class="dt">lty =</span> <span class="dv">3</span>,  <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">1.65</span>),  <span class="dt">main =</span> <span class="st">&#39;Density comparison&#39;</span>, <span class="dt">xlab =</span> <span class="st">&#39;&#39;</span>,<span class="dt">ylab =</span> <span class="st">&#39;values&#39;</span>)</a>
<a class="sourceLine" id="cb4-40" title="40"></a>
<a class="sourceLine" id="cb4-41" title="41"><span class="kw">lines</span>(<span class="kw">density</span>(MyMLE), <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">lty =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb4-42" title="42"></a>
<a class="sourceLine" id="cb4-43" title="43"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;Sample&quot;</span>,<span class="st">&quot;MLE&quot;</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>) , <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">5</span>),  <span class="dt">title =</span> <span class="st">&quot;Legend&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">cex =</span> <span class="fl">0.75</span>)</a>
<a class="sourceLine" id="cb4-44" title="44"></a>
<a class="sourceLine" id="cb4-45" title="45"></a>
<a class="sourceLine" id="cb4-46" title="46"><span class="co"># the corresponding QQ-Plots</span></a>
<a class="sourceLine" id="cb4-47" title="47"></a>
<a class="sourceLine" id="cb4-48" title="48"><span class="kw">qqplot</span>(data, data_MLE)</a></code></pre></div>
</div>
</div>
<div id="fitmixgg4-function" class="section level2">
<h2>fitmixgg4 function</h2>
<div id="description-4" class="section level3">
<h3>Description</h3>
<p>Functions to fit a sample (multivariate population – non-censored data) to generalized gamma family distributions. Note that different sets of parameters conduce to same density function with Amoroso family df’s. The approach is only empiric. The methodology is based on learning algorithm in order to mimic multivariate population to Amoroso family distributions. Selecting an appropriate distance measure (or metric) is fundamental such as k-means, nearest neighbor searches, and others. However, choosing such a measure is highly problem-specific and ultimately dictates the success—or failure—of the learning algorithm. We bring back our observed multivariate population in nc clusters of univariate subpopulations. In this aim, We propose a variant of the classical kmeans in order to identify the sub-populations, and each sub population is fitted with mimic() function dedicated to univariate distribution of Amoroso’s family distributions. Note: The number of components do not corresponds to the number of modes but the number of clusters obtained (TO EXPLAIN IN MORE DETAILS: TO DO)</p>
</div>
<div id="value-2" class="section level3">
<h3>Value</h3>
<ul>
<li>ftmixgg4 mimics the density function of an bivariate population.</li>
</ul>
</div>
<div id="usage-4" class="section level3">
<h3>Usage</h3>
<ul>
<li>fitmixgg4(data, nc, distance = “Wass”, par_init = c(0.15,0.15,-0.15,0.15), seed = 963, iter = 2, nrSimul = 200)</li>
</ul>
</div>
<div id="arguments-3" class="section level3">
<h3>Arguments</h3>
<ul>
<li><p>data: sample (bivariate population) to mimic: matrix format only !!!!!!!.</p></li>
<li><p>nc: two or three sub population</p></li>
<li><p>distance: A character string coding for the fitting method. Seven distances are proposed:</p>
<pre><code>      + &quot;Wass&quot; for Wasserstein distance, 
      + &quot;Burg&quot; for Burg entropy,
      + &quot;NegBurg&quot; for Negative Burg entropy, 
      + &quot;Chi2&quot; for chi-squared distance,
      + &quot;Euclid&quot; for the well-known Euclidian distance, 
      + &quot;Hell&quot; for Hellinger distance,
      + &quot;HL1N&quot; for half l1-norm distance. 
      All distances are described below. 
      Default value: &quot;Wass&quot; for Wasserstein distance.</code></pre></li>
<li><p>para_init: vector of the initial values of parameters . Default values: c(0.15,0.15,-0.15,0.15) corresponding to c(a,l,c,mu) for GG4.</p></li>
<li><p>seed: Number corresponding to the initialized kernel of random number generation. Default value = 963</p></li>
<li><p>iter: Number of iterations. Default value = 10.</p></li>
<li><p>nrSimul Number of iterations.</p></li>
</ul>
</div>
<div id="the-seven-distances-1" class="section level3">
<h3>The seven distances</h3>
<p>The new estimation method called ‘mimic’ is based on optimization and simulation coupling approaches. The proposed method is very practical and straightforward.</p>
<p>Seven new estimators were proposed incorporating minimum distance estimation for determining the “four-best” parameters of GG4.</p>
<p>The concept is near to the minimum distance approach in order to identify a distribution function (with the corresponding parameters) that is as close as possible to the empirical distribution with the following estimators:</p>
<ol style="list-style-type: decimal">
<li><p>distance = “Wass” – Wasserstein (also known as Earth mover’s distance or written Vaserstein) metric is a distance function defined between probability distributions on a given metric space M,</p></li>
<li><p>distance = “Burg” – Burg Divergence is a Bregman divergence which measures of how one probability distribution diverges from a second expected probability distribution,</p></li>
<li><p>distance = “NegBurg” – for Negative Burg Entopy is a (pre-)Bregman divergence,</p></li>
<li><p>distance = “chi2” – for chi-squared distance,</p></li>
<li><p>distance = “Euclid” – for Euclidian distance,</p></li>
<li><p>distance = “Hell” – for Hellinger distance,</p></li>
<li><p>distance = “HL1N” – for half l1-norm distance.</p></li>
</ol>
</div>
<div id="examples-2" class="section level3">
<h3>Examples</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="co"># R code</span></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="co"># ======</span></a>
<a class="sourceLine" id="cb6-3" title="3"></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="kw">library</span> (AmoRosoDistrib)</a>
<a class="sourceLine" id="cb6-5" title="5"><span class="kw">data</span>(<span class="st">&quot;anorexia&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;MASS&quot;</span>)</a>
<a class="sourceLine" id="cb6-6" title="6"></a>
<a class="sourceLine" id="cb6-7" title="7">y =<span class="st"> </span>MyData<span class="op">$</span>Postwt <span class="op">-</span><span class="st"> </span>MyData<span class="op">$</span>Prewt  <span class="co"># bivariate</span></a>
<a class="sourceLine" id="cb6-8" title="8">y =<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">unlist</span>(y))</a>
<a class="sourceLine" id="cb6-9" title="9"></a>
<a class="sourceLine" id="cb6-10" title="10"><span class="co">#Note: &#39;data&#39; should definitely not be a dataframe !!!!!</span></a>
<a class="sourceLine" id="cb6-11" title="11"> </a>
<a class="sourceLine" id="cb6-12" title="12">microbenchmark<span class="op">::</span><span class="kw">microbenchmark</span>(</a>
<a class="sourceLine" id="cb6-13" title="13"> params &lt;-<span class="st"> </span><span class="kw">fitmixgg4</span>(<span class="dt">data =</span> y,</a>
<a class="sourceLine" id="cb6-14" title="14">                     <span class="dt">nc =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb6-15" title="15">                     <span class="dt">distance =</span> <span class="st">&quot;Wass&quot;</span>,</a>
<a class="sourceLine" id="cb6-16" title="16">                     <span class="dt">par_init =</span> <span class="kw">c</span>(<span class="fl">0.15</span>,<span class="fl">0.15</span>,<span class="fl">0.15</span>,<span class="fl">0.15</span>),</a>
<a class="sourceLine" id="cb6-17" title="17">                     <span class="dt">seed =</span> <span class="dv">963</span>,</a>
<a class="sourceLine" id="cb6-18" title="18">                     <span class="dt">iter =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb6-19" title="19">                     <span class="dt">nrSimul =</span> <span class="dv">1000</span>),</a>
<a class="sourceLine" id="cb6-20" title="20"> <span class="dt">times =</span> 10L)</a>
<a class="sourceLine" id="cb6-21" title="21"> params</a>
<a class="sourceLine" id="cb6-22" title="22"></a>
<a class="sourceLine" id="cb6-23" title="23"></a>
<a class="sourceLine" id="cb6-24" title="24"></a></code></pre></div>
</div>
</div>
<div id="others-functions" class="section level2">
<h2>Others functions</h2>
<div id="description-5" class="section level3">
<h3>Description</h3>
<p>The package also proposes different description functions:</p>
<ul>
<li><p>mean_theo(): Mean estimated from the 4-parameters Generalized Gamma distribution.</p></li>
<li><p>var_theo(): Variance estimated from the 4-parameters Generalized Gamma distribution.</p></li>
<li><p>moment_theo(): Moment estimated from the 4-parameters of a Generalized Gamma distribution.</p></li>
<li><p>moment(): Centred moment estimated from a univariate population. Except for the first moment which corresponds to the mean.</p></li>
<li><p>kurtosis(): Kurtosis of a univariate population.</p></li>
<li><p>skweness(): Skewness of a data population ( measure of symmetry).</p></li>
</ul>
</div>
<div id="usage-5" class="section level3">
<h3>Usage</h3>
<ul>
<li>moment_theo(a, l, c, mu, k)</li>
<li>var_theo(a, l, c, mu)</li>
</ul>
<p>Mean and Variance for the 4-parameter generalized gamma distribution are respectively: <span class="math display">\[E[Y] = \frac{a \Gamma \left(\ell + \frac{1}{c}\right)}{\Gamma(\ell)} + \mu\]</span></p>
<p><span class="math display">\[V[Y] = a^2 \frac{ \Gamma \left(\ell + \frac{2}{c}\right)\Gamma(\ell) - \left[\Gamma \left(\ell + \frac{1}{c}\right) \right]^2 }{\Gamma(\ell)^2}\]</span></p>
<ul>
<li>moment_theo(a, l, c, mu, k)</li>
</ul>
<p>The <span class="math inline">\(r^{th}\)</span> moment of <span class="math inline">\(Y (r = 1, 2, ...)\)</span> is:</p>
<p><span class="math inline">\(E[Y^r] = a^r \frac{\Gamma \left( \frac{c \ell + r }{c} \right)}{\Gamma(\ell)}\)</span></p>
<p>if <span class="math inline">\(\frac{r}{c}&gt;-\ell\)</span> and <span class="math inline">\(\infty\)</span> otherwise</p>
<ul>
<li>moment(data, k)</li>
</ul>
<p>The Centred moment estimated from a univariate population (Except for the first moment which corresponds to the mean).</p>
<ul>
<li>Kurtosis(data, type = “sample”)</li>
</ul>
<p>kurtosis(sample): <span class="math inline">\(\frac {n (n+1)}{(n-1)(n-2) (n-3)} \sum_{i=1}^n \left( \frac{y_i-\overline{y}}{\frac {1}{n}\sum_{i=1}^n (y_i-\overline{y})^2} \right)^4\)</span></p>
<p>kurtosis(fisher): <span class="math inline">\(\frac{(n+1)(n-1)}{(n-2)(n-3)} \left[ \frac{\sum_{i=1}^n \frac{y_{i}^4}{n}}{\left( \frac{y_{i}}{n} \right)^2} - \frac{3(n-1)}{n+1}\right]\)</span></p>
<p>The excess kurtosis will be described in a next version of the package</p>
<ul>
<li>skweness(data, type = “sample”)</li>
</ul>
<p>skewness(sample): <span class="math inline">\(\frac {n}{(n-1)(n-2)} \sum_{i=1}^n \left( \frac{y_i-\overline{y}}{\frac {1}{n}\sum_{i=1}^n (y_i-\overline{y})^2} \right)^3\)</span></p>
<p>skewness(fisher): <span class="math inline">\(\frac {\frac{\sqrt{n(n-1)}}{n-2} \sum_{i=1}^n \left( \frac{y^3}{n} \right)}{\sum_{i=1}^n \left(\frac{y^2}{n} \right)^{\frac{3}{2}}}\)</span></p>
</div>
<div id="arguments-4" class="section level3">
<h3>Arguments</h3>
<ul>
<li>data: a sample (set of observations)</li>
<li>a: scale parameter of GG4 distribution</li>
<li>l: shape parameter of GG4 distribution</li>
<li>c: power shape parameter of GG4 distribution</li>
<li>mu: location parameter of GG4 distribution</li>
<li>k: k order to be computed</li>
<li>type: a character string coding – “sample” is computed from sample. “fisher” corresponds to fisher formulaes.</li>
</ul>
</div>
<div id="references-3" class="section level3">
<h3>References</h3>
</div>
<div id="examples-3" class="section level3">
<h3>Examples</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="co"># R code</span></a>
<a class="sourceLine" id="cb7-2" title="2"><span class="co"># ======</span></a>
<a class="sourceLine" id="cb7-3" title="3"></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="kw">library</span> (AmoRosoDistrib)</a>
<a class="sourceLine" id="cb7-5" title="5">n =<span class="st"> </span><span class="dv">30</span> <span class="co"># n value corresponding to the sample size for fitting</span></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="co">## set.seed function to get reproducible results</span></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="kw">set.seed</span>(<span class="dv">963</span>)</a>
<a class="sourceLine" id="cb7-8" title="8">MyData =<span class="st"> </span><span class="kw">rgg4</span>(n,<span class="dv">3</span>,<span class="dv">2</span>,<span class="op">-</span><span class="fl">1.75</span>,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb7-9" title="9">MyData</a>
<a class="sourceLine" id="cb7-10" title="10">nrSimul =<span class="st"> </span><span class="dv">150</span></a>
<a class="sourceLine" id="cb7-11" title="11"></a>
<a class="sourceLine" id="cb7-12" title="12"><span class="co"># Waiting time some minutes...........</span></a>
<a class="sourceLine" id="cb7-13" title="13"></a>
<a class="sourceLine" id="cb7-14" title="14">allRep &lt;-<span class="st"> </span><span class="kw">replicate</span>(nrSimul,(<span class="kw">mimicgg4</span>(<span class="dt">data =</span> MyData, <span class="dt">distance =</span> <span class="st">&quot;Wass&quot;</span>,</a>
<a class="sourceLine" id="cb7-15" title="15">                                      <span class="dt">par_init =</span> <span class="kw">c</span>(<span class="fl">0.35</span>,<span class="fl">0.35</span>,<span class="op">-</span><span class="fl">0.15</span>,<span class="fl">0.35</span>),</a>
<a class="sourceLine" id="cb7-16" title="16">                                      <span class="dt">seed =</span> <span class="kw">round</span>(<span class="kw">runif</span>(<span class="dv">1</span>,<span class="dt">min =</span> <span class="dv">1</span>,<span class="dt">max  =</span> <span class="dv">10</span><span class="op">^</span><span class="dv">8</span>)),</a>
<a class="sourceLine" id="cb7-17" title="17">                                      <span class="dt">iter =</span> <span class="dv">10</span>)))</a>
<a class="sourceLine" id="cb7-18" title="18"></a>
<a class="sourceLine" id="cb7-19" title="19">allRep</a>
<a class="sourceLine" id="cb7-20" title="20"></a>
<a class="sourceLine" id="cb7-21" title="21"><span class="co">####################################################</span></a>
<a class="sourceLine" id="cb7-22" title="22"></a>
<a class="sourceLine" id="cb7-23" title="23">j =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb7-24" title="24">min_w =<span class="st"> </span><span class="dv">9999999</span></a>
<a class="sourceLine" id="cb7-25" title="25"><span class="kw">require</span>(transport)</a>
<a class="sourceLine" id="cb7-26" title="26"></a>
<a class="sourceLine" id="cb7-27" title="27"></a>
<a class="sourceLine" id="cb7-28" title="28"><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></a>
<a class="sourceLine" id="cb7-29" title="29"><span class="co"># Wassertein distance</span></a>
<a class="sourceLine" id="cb7-30" title="30"><span class="cf">for</span> (j <span class="cf">in</span>  <span class="dv">1</span><span class="op">:</span>nrSimul) {</a>
<a class="sourceLine" id="cb7-31" title="31">  wa =<span class="st"> </span>allRep[<span class="dv">1</span>,j]</a>
<a class="sourceLine" id="cb7-32" title="32">  wl =<span class="st"> </span><span class="kw">abs</span>(allRep[<span class="dv">2</span>,j])</a>
<a class="sourceLine" id="cb7-33" title="33">  wc =<span class="st"> </span>allRep[<span class="dv">3</span>,j]</a>
<a class="sourceLine" id="cb7-34" title="34">  wmu =<span class="st"> </span>allRep[<span class="dv">4</span>,j]</a>
<a class="sourceLine" id="cb7-35" title="35"></a>
<a class="sourceLine" id="cb7-36" title="36">  <span class="kw">set.seed</span>(<span class="dv">963</span>) <span class="co"># generalized cases of GG4</span></a>
<a class="sourceLine" id="cb7-37" title="37">  w.est =<span class="st"> </span><span class="kw">rgg4</span>(n,wa,wl,wc,wmu)</a>
<a class="sourceLine" id="cb7-38" title="38"></a>
<a class="sourceLine" id="cb7-39" title="39">  w =<span class="st"> </span><span class="kw">wasserstein1d</span>(MyData,w.est,<span class="dt">p =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb7-40" title="40">  <span class="cf">if</span> (w <span class="op">!=</span><span class="st"> &quot;NaN&quot;</span>) {</a>
<a class="sourceLine" id="cb7-41" title="41">    <span class="cf">if</span> (min_w <span class="op">&gt;</span><span class="st"> </span>w) {</a>
<a class="sourceLine" id="cb7-42" title="42">      min_w =<span class="st"> </span>w</a>
<a class="sourceLine" id="cb7-43" title="43">      rw =<span class="st"> </span>j</a>
<a class="sourceLine" id="cb7-44" title="44">    }</a>
<a class="sourceLine" id="cb7-45" title="45">  }</a>
<a class="sourceLine" id="cb7-46" title="46">}</a>
<a class="sourceLine" id="cb7-47" title="47"></a>
<a class="sourceLine" id="cb7-48" title="48">rw</a>
<a class="sourceLine" id="cb7-49" title="49">min_w</a>
<a class="sourceLine" id="cb7-50" title="50"></a>
<a class="sourceLine" id="cb7-51" title="51">wwa =<span class="st"> </span>(allRep[<span class="dv">1</span>,rw])</a>
<a class="sourceLine" id="cb7-52" title="52">wwl =<span class="st"> </span>(allRep[<span class="dv">2</span>,rw])</a>
<a class="sourceLine" id="cb7-53" title="53">wwc =<span class="st"> </span>(allRep[<span class="dv">3</span>,rw])</a>
<a class="sourceLine" id="cb7-54" title="54">wwmu =<span class="st"> </span>(allRep[<span class="dv">4</span>,rw])</a>
<a class="sourceLine" id="cb7-55" title="55"><span class="kw">c</span>(wwa,wwl,wwc,wwmu)</a>
<a class="sourceLine" id="cb7-56" title="56"></a>
<a class="sourceLine" id="cb7-57" title="57"><span class="kw">set.seed</span>(<span class="dv">963</span>)</a>
<a class="sourceLine" id="cb7-58" title="58">y_est =<span class="st"> </span><span class="kw">rgg4</span>(<span class="kw">length</span>(MyData),wwa,wwl,wwc,wwmu)</a>
<a class="sourceLine" id="cb7-59" title="59"></a>
<a class="sourceLine" id="cb7-60" title="60"><span class="co"># Description univariate population versus estimated sample with MBD</span></a>
<a class="sourceLine" id="cb7-61" title="61">k_obs     =<span class="st"> </span><span class="kw">kurtosis</span>(<span class="dt">data =</span> MyData, <span class="dt">type =</span> <span class="st">&quot;sample&quot;</span>) <span class="co"># univariate pop</span></a>
<a class="sourceLine" id="cb7-62" title="62">s_obs     =<span class="st"> </span><span class="kw">skweness</span>(<span class="dt">data =</span> MyData, <span class="dt">type =</span> <span class="st">&quot;sample&quot;</span>)</a>
<a class="sourceLine" id="cb7-63" title="63">k_theo    =<span class="st"> </span><span class="kw">kurtosis</span>(<span class="dt">data =</span> y_est, <span class="dt">type =</span> <span class="st">&quot;sample&quot;</span>) <span class="co"># estimated sample</span></a>
<a class="sourceLine" id="cb7-64" title="64">s_theo    =<span class="st"> </span><span class="kw">skweness</span>(<span class="dt">data =</span> y_est, <span class="dt">type =</span> <span class="st">&quot;sample&quot;</span>)</a>
<a class="sourceLine" id="cb7-65" title="65">mean_theo =<span class="st"> </span><span class="kw">mean_theo</span>(wwa,wwl,wwc,wwmu)</a>
<a class="sourceLine" id="cb7-66" title="66"></a>
<a class="sourceLine" id="cb7-67" title="67">var_theo  =<span class="st"> </span><span class="kw">var_theo</span>(wwa,wwl,wwc,wwmu)</a>
<a class="sourceLine" id="cb7-68" title="68">var_obs   =<span class="st"> </span><span class="kw">moment</span>(MyData,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb7-69" title="69">mean_obs  =<span class="st"> </span><span class="kw">moment</span>(MyData,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb7-70" title="70">var_est   =<span class="st"> </span><span class="kw">moment</span>(y_est,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb7-71" title="71">mean_est  =<span class="st"> </span><span class="kw">moment</span>(y_est,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb7-72" title="72"></a>
<a class="sourceLine" id="cb7-73" title="73"><span class="kw">c</span>(mean_obs,mean_est, mean_theo)</a>
<a class="sourceLine" id="cb7-74" title="74"><span class="kw">c</span>(var_obs,var_est, var_theo)</a>
<a class="sourceLine" id="cb7-75" title="75"><span class="kw">c</span>(k_obs,k_theo)</a>
<a class="sourceLine" id="cb7-76" title="76"><span class="kw">c</span>(s_obs,s_theo)</a>
<a class="sourceLine" id="cb7-77" title="77"></a>
<a class="sourceLine" id="cb7-78" title="78"></a>
<a class="sourceLine" id="cb7-79" title="79"></a>
<a class="sourceLine" id="cb7-80" title="80"><span class="co"># Sample generation with initialization kernel of pseudo random number</span></a>
<a class="sourceLine" id="cb7-81" title="81"><span class="kw">set.seed</span>(<span class="dv">963</span>)</a>
<a class="sourceLine" id="cb7-82" title="82">MyData=<span class="kw">rgg4</span>(<span class="dt">n =</span> <span class="dv">1000</span>,<span class="dt">a =</span> <span class="dv">2</span>,<span class="dt">l =</span> <span class="dv">3</span>,<span class="dt">c =</span> <span class="fl">-0.75</span>,<span class="dt">mu =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb7-83" title="83"></a>
<a class="sourceLine" id="cb7-84" title="84"><span class="co"># Fit univariate sample in order to identify the four parameter</span></a>
<a class="sourceLine" id="cb7-85" title="85"><span class="co"># with burg divergence method</span></a>
<a class="sourceLine" id="cb7-86" title="86">res=<span class="kw">mimicgg4</span>(<span class="dt">data =</span> MyData, <span class="dt">distance =</span> <span class="st">&quot;Burg&quot;</span>, <span class="dt">par_init =</span> <span class="kw">c</span>(<span class="fl">0.15</span>,<span class="fl">0.15</span>,<span class="op">-</span><span class="fl">0.15</span>,<span class="fl">0.15</span>), </a>
<a class="sourceLine" id="cb7-87" title="87">             <span class="dt">seed =</span> <span class="dv">963</span>, <span class="dt">iter =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb7-88" title="88"><span class="co"># res[1] = a, res[2] = l, res[3] = c, res[4] = mu</span></a>
<a class="sourceLine" id="cb7-89" title="89">res</a>
<a class="sourceLine" id="cb7-90" title="90"><span class="co">#[1]  0.7983483  0.2650324 -8.3710544  4.3995720</span></a>
<a class="sourceLine" id="cb7-91" title="91"></a>
<a class="sourceLine" id="cb7-92" title="92">set.seed =<span class="st"> </span><span class="dv">963</span></a>
<a class="sourceLine" id="cb7-93" title="93">Theo_Data =<span class="st"> </span><span class="kw">rgg4</span>(<span class="dt">n =</span> <span class="dv">1000</span>, <span class="dt">a =</span> res[<span class="dv">1</span>], <span class="dt">l =</span> res[<span class="dv">2</span>], <span class="dt">c =</span> res[<span class="dv">3</span>], <span class="dt">mu =</span> res[<span class="dv">4</span>])</a>
<a class="sourceLine" id="cb7-94" title="94"></a>
<a class="sourceLine" id="cb7-95" title="95"><span class="co"># Description univariate population versus estimated sample</span></a>
<a class="sourceLine" id="cb7-96" title="96">k_MyData  =<span class="st"> </span><span class="kw">kurtosis</span>(<span class="dt">data =</span> MyData)</a>
<a class="sourceLine" id="cb7-97" title="97">k_Fisher  =<span class="st"> </span><span class="kw">kurtosis</span>(<span class="dt">data =</span> MyData, <span class="dt">type =</span> <span class="st">&quot;fisher&quot;</span>)</a>
<a class="sourceLine" id="cb7-98" title="98">k_theo    =<span class="st"> </span><span class="kw">kurtosis</span>(<span class="dt">data =</span> Theo_Data)</a>
<a class="sourceLine" id="cb7-99" title="99">s_MyData  =<span class="st"> </span><span class="kw">skweness</span>(<span class="dt">data =</span> MyData)</a>
<a class="sourceLine" id="cb7-100" title="100">s_Fisher  =<span class="st"> </span><span class="kw">skweness</span>(<span class="dt">data =</span> MyData, <span class="dt">type =</span> <span class="st">&quot;fisher&quot;</span>)</a>
<a class="sourceLine" id="cb7-101" title="101">s_theo    =<span class="st"> </span><span class="kw">skweness</span>(<span class="dt">data =</span> Theo_Data)</a>
<a class="sourceLine" id="cb7-102" title="102"><span class="kw">c</span>(k_MyData,k_Fisher,k_theo)</a>
<a class="sourceLine" id="cb7-103" title="103"><span class="kw">c</span>(s_MyData,s_Fisher,s_theo)</a>
<a class="sourceLine" id="cb7-104" title="104">mean_theo =<span class="st"> </span><span class="kw">mean_theo</span>(res[<span class="dv">1</span>],res[<span class="dv">2</span>],res[<span class="dv">3</span>],res[<span class="dv">4</span>])</a>
<a class="sourceLine" id="cb7-105" title="105">var_theo  =<span class="st"> </span><span class="kw">var_theo</span>(res[<span class="dv">1</span>],res[<span class="dv">2</span>],res[<span class="dv">3</span>],res[<span class="dv">4</span>])</a>
<a class="sourceLine" id="cb7-106" title="106">var_MyData   =<span class="st"> </span><span class="kw">moment</span>(MyData,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb7-107" title="107">mean_MyData  =<span class="st"> </span><span class="kw">moment</span>(MyData,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb7-108" title="108"><span class="kw">c</span>(mean_MyData,mean_theo)</a>
<a class="sourceLine" id="cb7-109" title="109"><span class="kw">c</span>(var_MyData,var_theo)</a></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
